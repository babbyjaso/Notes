### Identifying Vulnerabilities
- it’s v important (duh)
- Every vulnerability is a risk that needs to be assessed.
- Vulnerability Assessment
	- an evaluation of a system’s security and ability to meet compliance requirements based on the configuration state of the system as represented by information collected from the system
	- it’s software that scans your network
	- steps:
		- collect a set of target attributes
		- analyze the differences in the current and baseline configurations
		- report
	- it’s an automated tool
- name of the game is priority of the system
### Scanning Workflow
- basic assessment scan workflow
- questions that need to be answered:
	- Who’s gonna conduct the scan?
	- When will the scan be performed?
	- Which systems will be scanned?
	- How will scanning impact the systems?
	- Does a system need to be isolated during scanning?
		- can you scan it while in prod?
	- Who can assist with the scanning?
- Now let’s to the workflow:
	1. Install software and patches to establish a baselined system
	2. perform an initial scan of the target system
	3. analyze the assessment reports based on the baseline
	4. perform corrective actions based on reported findings
	5. Repeat from 2
	6. Document findings and create reports for relevant stakeholders
	7. Conduct ongoing scanning to ensure continual remediation
- Scan > Patch > Scan
### Scope Considerations
- What kind of scan are you going to do?
- Nikto
	- web vuln scanner that analyzes applications for
		- SQL injection
		- XSS
		- Source code and database security
- we’re gonna do infrastructure vuln scanners
	- can perform mapping and enumeration in the form of a host discovery scan
- will compile a report and tell you who knows how to exploit it and how to remediate.
- Scope
	- the range of hosts or subnets included within a single scan job
	- important to adjust the scope to make it efficient
		- schedule scans of different portions of the scope for different times of the day
		- configure your scope based on a particular compliance objective
		- rescan scopes containing critical assets more often
- Internal vs External
	- internal scanning
		- vuln scans being conducted against your network from inside your local network
		- can be used to have a credential scan
	- external scanning
		- vuln scans being conducted against your network from outside your local network
### Scanner Types
- different ways to configure scanners
- Here’s some different modes;
	- passive
		- enumeration or vuln scan that analyzes only intercepted network traffic rather than sending probes to a target
		- least impact on the network, but won’t find many holes
	- active
		- enum or vuln scan that analyzes the responses from probes sent to a target
		- high impact on the network, will find holes
		- can be configured in the following ways:
	- credentialed
		- vuln scanner is given user account to log on to the target systems or hosts
		- likely to find vulns and misconfigurations
	- non-credentialed
		- the vuln scanner sends test packets against a target without logging onto the system or hosts
		- probes targets with default passwords and vulns within applications
		- good for external assessments
	- server-based
		- vuln scan is launched from one or more scanning servers against the targets
	- agent-based
		- vuln scanning is conducted using a software application installed locally on each target
		- managed by an admin server and scans are run on a schedule
- More on agent-based
	- agent-based scanning advantages:
		- reduce impact on the network
		- better for mobile or remote devices when offline
	- agent-based disadvantages;
		- limited to a particular OS
		- agent software could be compromised by malware
	- because of those points: we do hybrid solutions
		- once again: defense in depth
### Scanning Parameters
- scanners need parameters to be effective in scanning the network
- gotta consider some things:
	- Segmentation
		- Division of a network into separate zones through the use of VLANs and subnetting
	- forces traffic to flow predictably between zones
- firewalls must be configured to allow agent-based scanners to report to a centralized management server
- IDS/IPS must be configured with an exception to allow for agent-based scanning
- FW/IDS/IPS will likely block server-based scanning unless exceptions are created
- Scanning window: when the firewall is disabled
	- seems like a bad idea lol
- Install scanners into segment and report back
	- seems like a much better idea
- or just one scanner and configure the firewall correctly
- gotta update these scanners too
### Scheduling and Constraints
- point in time assessment
- frequency is whatever you decide it to be based on risk analysis
- recommendation: should be performed weekly
- when you should scan:
	- Deployment of new or updated systems
	- identification of new vulnerabilities
	- following a security breach
	- regulatory or oversight requirements
	- regularly scheduled
- why not scan constantly?
	- feed updating
	- resource usage
		- money
		- computer limitations
- scan frequency and technique will be affected by the data type processed by the target
	- if there’s super sensitive info, you should probably scan it more often.
- utilize a Privilege access management solution (PAM) to mitigate the risk of an insider threat
- if all else fails, make a timeframe for scanning for privilege account
### Vulnerability Feeds
- Vulnerability Feed
	- synchronized list of data and scripts used to check for vulnerabilities, also known as plug-ins or network vulnerability tests (NVTs)
- many commercial vuln scanners require an ongoing paid sub to access feeds
- Common format: Security Content Automation Protocol (SCAP)
	- NIST framework that outlines various accepted practices for automating vuln scanning by adhering to standards for scanning and processes, results reporting and scoring and vuln prioritization
	- used to uphold internal and external compliance requirements
- Open Vulnerability and Assessment Language (OVAL)
- Extensible Configuration Checklist Description Format (XCCDF)
	- XML schema for auditing best-practice configurations
### Scan Sensitivity
- amount and intensity of vulns to test against a target
- scan template
	- defines settings used for each scan
- 4 basic scans
	- Discovery Scan
		- used to create and update an inventory of assets by conducting enumeration of the network and its targets without scanning for vulnerabilities
		- nmap scan basically
	- Fast/Basic Assessment Scan
		- scan that contains options for analyzing hosts for unpatched software vulns and configuration issues
		- engine will probably disable the windows plug-ins when scanning linux hosts
	- Full/Deep Assessment Scan
		- comprehensive scan that forces the use of more plug-in types, takes longer to conduct host scanning, and has more risk of causing a service disruption
		- will ignore previous results and fully rescan everything
	- Compliance Scan
		- scan based on a compliance template or checklist to ensure the controls and configuration settings are properly applied to a given target or host
		- some compliance orgs require frequency
			- Exam tip: PCI DSS = quarterly scan
### Scanning Risks
- when you scan stuff, you can break stuff
	- printers
	- voip phones
	- embedded systems
- need to protect these scan results
- use service accounts to conduct credentialed scans, not local admin privileges
- sometimes need to open ports too, yikes
- be sure to configure IPs for your scanning servers to minimize network attack surface