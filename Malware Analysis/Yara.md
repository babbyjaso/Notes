- Yet Another Ridiculous Acronym (YARA)
- Computer language that can identify information based on both binary and textual patterns.
	- Hexadecimal _and_ strings
- rules are used to label these patterns
	- typically to determine if a file is malicious or not
	- this is based on the patterns it detects
- Yara is on FlareVM!
	- you write the rules and then push them to yara
- Yara is probably better on your host machine because you're not gonna roll that back (hopefully)
- Keywords:
	- [Read the docs](https://yara.readthedocs.io/en/stable/writingrules.html#)
	- three sections generally
	- `meta`
		- metadata for the rule
		- last updated, author, description, etc.
	- `strings`
		- checks if a string is in a file
		- start with `$string1` to set the string variable
			- be sure to wrap it in double quotes
		- specify the string type like hex or ascii
		- perform again for any additional string variables that you see in the malware that can be used to detect the malware
		- you can also set bytes using `{}` 
			- can wildcard (using `??`) these bytes as well
		- Need to have every string match a condition
		- Will end up with something like this:
```example
strings:
	$string1 = "YOURETHEMANNOWDOG" ascii
	$string2 = "nim"
	$PE_magic_byte = "MZ"
	$sus_hex_string = { FF E4 ?? 00 FF }
```
- Now that we've defined the strings as functions, we have to apply them
	- `condition`
		- We can specify where a string is going to be
		- We can specify that a rule must have the two strings we set before
		- We can specify that a rule can have either of the two strings we set before
		- Can use `>=`, `<=`, and `!=`
		- Can use `and`, `not`, and `or`
		- General query language building
		- Can end up something like this:
```example
condition:
	$PE_magic_byte at 0 and
	($string1 and $string2) or

	$sus_hex_string
```
- Running it against the file
	- We made the rule, time to test it
	- `yara`
		- first argument: the rule we want to test
		- second argument: the file/directory we want to test it on
			- `.` for the current working directory
			- specify the directory instead of specifying the file
			- `-r` for a recursive scan
		- `-w` suppress warnings
		- `-p` how many threads you want to use for this
			- up to 32
		- `-s` to show the strings it detected
			- will show you the position it detected them in as well
		- If it spits something out, you got a hit
			- you'll see the rule name after the `rule` in the script