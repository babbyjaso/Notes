- Record any observed symptoms of infection from initial detonation. What are the main symptoms of a WannaCry infection?
	- Encrypted files
	- pop up demanding money
	- wallpaper changed
	- creates wannacry decrypter
	- needs admin privs
- Use FLOSS and extract the strings from the main WannaCry binary. Are there any strings of interest?
	- hxxp://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
	- icacls . /grant Everyone:F /T /C /Q
		- [icalcs docs](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls)
	- lhdfrgui.exe
		- https://www.virustotal.com/gui/file/24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c
		- copy of wannacry
		- probably original filename
		- ![[Pasted image 20240928140453.png]]
	- `\192.168.56.20\IPC$`
		- looking at the IPC share for all IPs on the subnet
- Inspect the import address table for the main WannaCry binary. Are there any notable API imports?
	- CryptAcquireContextA
	- CryptGenRandom
		- Randomize crypt
	- SizeofResource
	- LockResource
	- LoadResource
	- FindResourceA
		- manipulate resources with this
	- rand
	- srand
	- MoveFileExA
- What conditions are necessary to get this sample to detonate?
	- Need Administrative privileges
	- if it does not reach the network indicator listed below
- **Network Indicators**: Identify the network indicators of this malware
	- hxxp://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
- **Host-based Indicators**: Identify the host-based indicators of this malware.
	- creation of a folder in the `C:\ProgramData\` directory
		- creation of files inside of that directory
			- check the process tree for the `taskshe.exe` that is a child of `wannacry.exe`
- Use Cutter to locate the killswitch mechanism in the decompiled code and explain how it functions.
	- ![[Pasted image 20240928151613.png]]