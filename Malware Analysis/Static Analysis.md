- Basic analysis ^static-bas
	- Using tools to look at the malware without executing it
		- get hashes
		- look at any [[PEview#^win-api|Windows API calls]]
		- look at any [[Strings]] in the malware
		- look at the size of the malware to see if it's [[Packed Malware|packed]] or not
	- tools to do this:
		- [[Strings]]
		- [[PEview]]
		- [[PEstudio]]
		- [[FLOSS]]
- Advanced analysis ^static-adv
	- Uses
		- Decompilers
		- Disassemblers
	- Tools:
		- [[Cutter]]
	- Looking at the assembly instructions of the malware (ASM)
		- ASM ^asm
			- Human readable CPU instruction set
			- CPU deals in binary, ASM is the pattern of binary put to somewhat human readable language
		- Compiler takes the human stuff (`print(hello world)`) and turns it into binary
		- Several things have to be present for a binary to execute:
			- CPU instructions
				- Arithmetic instructions
					- `sub`
						- subtract numbers, even parts of memory
				- Data movement instructions
					- action destination, source
					- `mov edx, eax`
						- move `eax` into `edx`
					- `jmp 0x...`
						- jump to a place in the memory
					- `jnz`
						- jump if not zero
					- `jne`
						- Jump if Not Equal to
						- equal to what? whatever came before
				- Control flow instructions
					- `push`
						- pushes things onto the stack
						- [[Cutter]] is super nice and will show us where on the stack it's pushed to
					- `pop`
						- removes the lowest part of the stack
					- `call`
						- calls functions, [[PEview#^win-api|Windows API]], etc
						- returns with what it came up with
						- main will resume from whatever it came back with
					- `ret`
						- return to the base point
			- Memory registers ^stat-mem
				- holds and handles data at runtime
					- ex: reading a tape
				- `eax`
					- accumulator register
				- `edx`
					- data register
				- `ebx`
					- base register
				- `esp`
					- extended stack pointer
					- moving the stack pointer into the base pointer is the setup for calling a function
						- this is called a stack frame
						- contains local variables, parameters and the stack pointer itself
				- `ebp`
					- extended base point
					- need this pushed in the main at the beginning so that we know where to return to with whatever the function came up with
					- `push ebp` is to preserver the calling function's base address
				- `eip`
					- extended instruction pointer
					- memory location of every next action to be executed
				- `ebp`
					- extended base pointer
				- `setne`
					- SET if Not Equal to
					- Sets the byte in the operand to 1 if the Zero Flag is clear, otherwise sets the operand to 0.
			- Stack ^stat-stack
				- stack grows downward
				- finds a place in memory and starts from zero and moves down
				- LIFO
					- Last In First Out
					- reads from the bottom up
	- Process Injection
		- program that will take a legitimate process and inject some kind of code into it
			- example here takes an argument in the code
				- in this case shell codea
			- passes this argument into a process
				- werfault.exe
			- then tells it to write the code to memory inside of the process
				- making room in the process memory for the code
			- then opens the remote thread
				- legit werfault.exe opened, but it's got a shell inside of it
		- This does start the process as the child process of the malicious program
			- after the `CreateRemoteThread` it becomes its own parent
			- lots of EDR solutions watch for `CreateRemoteThread` so this is also rookie hours